<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>One-way ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.31/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./oneway_anova.html">One-way ANOVA</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./UQAC_Couleur.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation &amp; Simple Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./non-parametric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other types of correlation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mutiple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./oneway_anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">One-way ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova_repeated_measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA with Repeated Measures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (fixed effects)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two_way_anova_fixed_random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (fixed and random effects)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-way-anova-random-block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (random block)</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link active" data-scroll-target="#assumptions">Assumptions</a></li>
  <li><a href="#box-8.1-worked-example-diatom-communities-in-metalaffected-streams" id="toc-box-8.1-worked-example-diatom-communities-in-metalaffected-streams" class="nav-link" data-scroll-target="#box-8.1-worked-example-diatom-communities-in-metalaffected-streams">Box 8.1 Worked example: diatom communities in metalaffected streams</a></li>
  <li><a href="#calculating-anova" id="toc-calculating-anova" class="nav-link" data-scroll-target="#calculating-anova">Calculating ANOVA</a></li>
  <li><a href="#other-way-of-getting-anova" id="toc-other-way-of-getting-anova" class="nav-link" data-scroll-target="#other-way-of-getting-anova">Other way of getting ANOVA</a></li>
  <li><a href="#checking-zinc-groups-in-terms-of-diversty" id="toc-checking-zinc-groups-in-terms-of-diversty" class="nav-link" data-scroll-target="#checking-zinc-groups-in-terms-of-diversty">Checking ZINC groups in terms of DIVERSTY</a></li>
  <li><a href="#residual-plot" id="toc-residual-plot" class="nav-link" data-scroll-target="#residual-plot">Residual plot</a></li>
  <li><a href="#levene-median-test" id="toc-levene-median-test" class="nav-link" data-scroll-target="#levene-median-test">Levene-median test</a></li>
  <li><a href="#levene-mean-test" id="toc-levene-mean-test" class="nav-link" data-scroll-target="#levene-mean-test">Levene-mean test</a></li>
  <li><a href="#tukeys-pairwise-comparison" id="toc-tukeys-pairwise-comparison" class="nav-link" data-scroll-target="#tukeys-pairwise-comparison">Tukey’s pairwise comparison</a></li>
  <li><a href="#kruskal-wallis-rank-sum-test-non-parametric" id="toc-kruskal-wallis-rank-sum-test-non-parametric" class="nav-link" data-scroll-target="#kruskal-wallis-rank-sum-test-non-parametric">Kruskal-Wallis rank sum test (non-parametric)</a></li>
  <li><a href="#pairwise-wilcoxon-rank-sum-tests" id="toc-pairwise-wilcoxon-rank-sum-tests" class="nav-link" data-scroll-target="#pairwise-wilcoxon-rank-sum-tests">Pairwise Wilcoxon Rank Sum Tests</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">One-way ANOVA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>ANOVA (Analysis of Variance) is a statistical method used to compare the means of three or more groups to determine if there are significant differences among them. It helps test the hypothesis that the means of different groups are equal. ANOVA essentially examines the variation within groups and between groups to assess whether the observed differences in sample means are due to chance or reflect true differences in the population.</p>
<section id="assumptions" class="level4">
<h4 class="anchored" data-anchor-id="assumptions">Assumptions</h4>
<p>ANOVA relies on several key assumptions to ensure the validity of its results. If these assumptions are violated, the results of the ANOVA test may not be reliable. Here are the main assumptions:</p>
<section id="independence-of-observations" class="level5">
<h5 class="anchored" data-anchor-id="independence-of-observations">1. <strong>Independence of Observations</strong>:</h5>
<ul>
<li><p>Each observation in the dataset must be independent of all others. This means that the outcome of one observation should not influence the outcome of another.</p></li>
<li><p><strong>How to check</strong>: This assumption is generally met by ensuring a proper study design (e.g., random sampling or random assignment).</p></li>
</ul>
</section>
<section id="normality" class="level5">
<h5 class="anchored" data-anchor-id="normality">2. <strong>Normality</strong>:</h5>
<ul>
<li><p>The residuals (differences between observed and predicted values) within each group should be approximately normally distributed.</p></li>
<li><p><strong>How to check</strong>: You can assess normality by using:</p>
<ul>
<li><p>A <strong>Q-Q plot</strong> (quantile-quantile plot) of the residuals.</p></li>
<li><p>Statistical tests like the <strong>Shapiro-Wilk test</strong> or <strong>Kolmogorov-Smirnov test</strong> (though these are sensitive in large datasets).</p></li>
</ul></li>
</ul>
<p><strong>Note</strong>: ANOVA is robust to moderate deviations from normality, especially when sample sizes are large and approximately equal across groups.</p>
</section>
<section id="homogeneity-of-variances-homoscedasticity" class="level5">
<h5 class="anchored" data-anchor-id="homogeneity-of-variances-homoscedasticity">3. <strong>Homogeneity of Variances (Homoscedasticity)</strong>:</h5>
<ul>
<li><p>The variance within each group should be approximately equal (i.e., the spread of the data within each group should be similar).</p></li>
<li><p><strong>How to check</strong>:</p>
<ul>
<li><p>Use <strong>Levene’s Test</strong> or <strong>Bartlett’s Test</strong> to formally test for equality of variances.</p></li>
<li><p>Alternatively, inspect boxplots or use graphical methods to evaluate variance homogeneity.</p></li>
</ul></li>
</ul>
</section>
<section id="additivity-and-linearity" class="level5">
<h5 class="anchored" data-anchor-id="additivity-and-linearity">4. <strong>Additivity and Linearity</strong>:</h5>
<ul>
<li><p>The relationship between the dependent variable and the predictors (in the case of two-way ANOVA) should be additive and linear.</p></li>
<li><p><strong>Additivity</strong> implies that the effect of one factor should not depend on the levels of another factor (no interaction effects).</p></li>
<li><p><strong>Linearity</strong> assumes a linear relationship between the predictors and the outcome variable.</p></li>
</ul>
</section>
<section id="fixed-effects" class="level5">
<h5 class="anchored" data-anchor-id="fixed-effects">5. <strong>Fixed Effects</strong>:</h5>
<ul>
<li>ANOVA assumes that the factors or groups being analyzed are <strong>fixed effects</strong>, meaning they are pre-determined and not randomly sampled from a larger population.</li>
</ul>
</section>
<section id="consequences-of-violating-assumptions" class="level5">
<h5 class="anchored" data-anchor-id="consequences-of-violating-assumptions">Consequences of Violating Assumptions:</h5>
<ul>
<li><p><strong>Violation of Independence</strong>: This is critical. Violations can severely compromise the test’s results, leading to misleading conclusions.</p></li>
<li><p><strong>Violation of Normality</strong>: If violated and the sample size is small, the ANOVA may produce inaccurate p-values. For larger sample sizes, ANOVA is relatively robust to this violation.</p></li>
<li><p><strong>Violation of Homogeneity of Variances</strong>: This can inflate the type I error rate (false positives) or type II error rate (false negatives). Use Welch’s ANOVA if this assumption is violated.</p></li>
</ul>
</section>
<section id="how-to-address-violations" class="level5">
<h5 class="anchored" data-anchor-id="how-to-address-violations">How to Address Violations:</h5>
<ul>
<li><p><strong>Transformations</strong> (e.g., log or square root transformations) can sometimes address issues with normality or unequal variances.</p></li>
<li><p>Use <strong>non-parametric alternatives</strong> like the <strong>Kruskal-Wallis test</strong> when normality and homoscedasticity assumptions are strongly violated.</p></li>
<li><p>If variances are unequal, use <strong>Welch’s ANOVA</strong> as a more robust alternative to traditional ANOVA.</p></li>
</ul>
<p>By ensuring these assumptions are met (or using appropriate alternatives when they are violated), you can make valid inferences from ANOVA results.</p>
<p><strong>Data we’ll use:</strong> <code>medley.csv</code> (chap 8), boîte 8.1 p.174 Quinn &amp; Keough</p>
</section>
</section>
<section id="box-8.1-worked-example-diatom-communities-in-metalaffected-streams" class="level4">
<h4 class="anchored" data-anchor-id="box-8.1-worked-example-diatom-communities-in-metalaffected-streams">Box 8.1 Worked example: diatom communities in metalaffected streams</h4>
<p>Medley &amp; Clements (1998) sampled a number of stations (between four and seven) on six streams known to be polluted by heavy metals in the Rocky Mountain region of Colorado, USA. They recorded zinc concentration, and species richness and species diversity of the diatom community and proportion of diatom cells that were the early-successional species, Achanthes minutissima.</p>
<section id="species-diversity-versus-zinc-level-group" class="level5">
<h5 class="anchored" data-anchor-id="species-diversity-versus-zinc-level-group">Species diversity versus zinc-level group</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get thedata</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/medley.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-687c94b65fca2dd94c50" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-687c94b65fca2dd94c50">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34"],["Eagle","Eagle","Eagle","Eagle","Blue","Blue","Blue","Blue","Blue","Blue","Blue","Snake","Snake","Snake","Snake","Snake","Arkan","Arkan","Arkan","Arkan","Arkan","Arkan","Arkan","Chalk","Chalk","Chalk","Chalk","Chalk","Splat","Splat","Splat","Splat","Splat","Splat"],["BACK","HIGH","HIGH","MED","BACK","HIGH","BACK","BACK","HIGH","MED","MED","BACK","MED","HIGH","HIGH","HIGH","LOW","LOW","LOW","LOW","MED","MED","LOW","LOW","HIGH","HIGH","MED","LOW","BACK","BACK","MED","LOW","MED","BACK"],[2.27,1.25,1.15,1.62,1.7,0.63,2.05,1.98,1.04,2.19,2.1,2.2,2.06,1.9,1.88,0.85,1.4,2.18,1.83,1.88,2.02,1.94,2.1,2.38,1.43,1.37,1.75,2.83,1.53,0.76,0.8,1.66,0.98,1.89],[1,4,4,3,1,4,1,1,4,3,3,1,3,4,4,4,2,2,2,2,3,3,2,2,4,4,3,2,1,1,3,2,3,1],[0.4725,-0.02777778,-0.12777778,-0.09777777999999999,-0.0975,-0.64777778,0.2525,0.1825,-0.23777778,0.47222222,0.38222222,0.4025,0.34222222,0.62222222,0.60222222,-0.42777778,-0.6325,0.1475,-0.2025,-0.1525,0.30222222,0.22222222,0.0675,0.3475,0.15222222,0.09222221999999999,0.03222222,0.7975,-0.2675,-1.0375,-0.91777778,-0.3725,-0.73777778,0.0925],[1.7975,1.277778,1.277778,1.717778,1.7975,1.277778,1.7975,1.7975,1.277778,1.717778,1.717778,1.7975,1.717778,1.277778,1.277778,1.277778,2.0325,2.0325,2.0325,2.0325,1.717778,1.717778,2.0325,2.0325,1.277778,1.277778,1.717778,2.0325,1.7975,1.7975,1.717778,2.0325,1.717778,1.7975],[0.6975,-0.3225,-0.4225,0.0475,0.03,-1.04,0.38,0.31,-0.63,0.52,0.43,0.422,0.282,0.122,0.102,-0.928,-0.50714286,0.27285714,-0.07714285999999999,-0.02714286,0.11285714,0.03285714,0.19285714,0.428,-0.522,-0.582,-0.202,0.878,0.26,-0.51,-0.47,0.39,-0.29,0.62],[1.5725,1.5725,1.5725,1.5725,1.67,1.67,1.67,1.67,1.67,1.67,1.67,1.778,1.778,1.778,1.778,1.778,1.907143,1.907143,1.907143,1.907143,1.907143,1.907143,1.907143,1.952,1.952,1.952,1.952,1.952,1.27,1.27,1.27,1.27,1.27,1.27]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>STREAM<\/th>\n      <th>ZINC<\/th>\n      <th>DIVERSTY<\/th>\n      <th>ZNGROUP<\/th>\n      <th>RESID1<\/th>\n      <th>PREDICT1<\/th>\n      <th>RESID2<\/th>\n      <th>PREDICT2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"STREAM","targets":1},{"name":"ZINC","targets":2},{"name":"DIVERSTY","targets":3},{"name":"ZNGROUP","targets":4},{"name":"RESID1","targets":5},{"name":"PREDICT1","targets":6},{"name":"RESID2","targets":7},{"name":"PREDICT2","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STREAM has 6 groups</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>STREAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Arkan  Blue Chalk Eagle Snake Splat 
    7     7     5     4     5     6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ZINC has 4 groups</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>ZINC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
BACK HIGH  LOW  MED 
   8    9    8    9 </code></pre>
</div>
</div>
</section>
</section>
<section id="calculating-anova" class="level4">
<h4 class="anchored" data-anchor-id="calculating-anova">Calculating ANOVA</h4>
<p>The first analysis compares mean diatom species <strong>diversity</strong> (response variable) across the four <strong>zinc-level groups</strong> (categorical predictor variable), zinc level treated as a fixed factor. The <span class="math inline">\(H_0\)</span> was no difference in mean diatom species diversity between zinc-level groups. The results from an analysis of variance from fitting a linear model with zinc level as the predictor variable were as follows.</p>
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
<th>P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Zinc level</td>
<td>2.567</td>
<td>3</td>
<td>0.856</td>
<td>3.939</td>
<td>0.018</td>
</tr>
<tr class="even">
<td>Residual</td>
<td>6.516</td>
<td>30</td>
<td>0.217</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>9.083</td>
<td>33</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(H_0\)</span>: The <strong>means</strong> of the different groups <strong>are the same</strong>.<br>
<span class="math inline">\(H_1\)</span>: At least one sample mean is not equal to the others.</p>
<p>P-value &lt; 0.05 = Reject <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(DIVERSTY <span class="sc">~</span> ZINC, <span class="at">data =</span> df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: DIVERSTY
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
ZINC       3 2.5666 0.85554  3.9387 0.01756 *
Residuals 30 6.5164 0.21721                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="other-way-of-getting-anova" class="level4">
<h4 class="anchored" data-anchor-id="other-way-of-getting-anova">Other way of getting ANOVA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(DIVERSTY <span class="sc">~</span> ZINC, <span class="at">data =</span> df)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
ZINC         3  2.567  0.8555   3.939 0.0176 *
Residuals   30  6.516  0.2172                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="checking-zinc-groups-in-terms-of-diversty" class="level4">
<h4 class="anchored" data-anchor-id="checking-zinc-groups-in-terms-of-diversty">Checking ZINC groups in terms of DIVERSTY</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> ZINC, <span class="at">y =</span> DIVERSTY)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="oneway_anova_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Boxplots of species diversity against group showed no obvious skewness. Two sites with low species diversity were highlighted in the background and medium zinc groups as possible outliers.</p>
</section>
<section id="residual-plot" class="level4">
<h4 class="anchored" data-anchor-id="residual-plot">Residual plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="oneway_anova_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The residual plot from this model did not reveal any outliers or any unequal spread of the residuals, suggesting the assumptions of the ANOVA were appropriate.</p>
</section>
<section id="levene-median-test" class="level4">
<h4 class="anchored" data-anchor-id="levene-median-test">Levene-median test</h4>
<p><span class="math inline">\(H_0\)</span>: no difference in variances of species diversity between zinc-level groups</p>
<p><span class="math inline">\(H_1\)</span>: different variances of species diversity between zinc-level groups</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(DIVERSTY <span class="sc">~</span> ZINC, <span class="at">data =</span> df, <span class="at">center =</span> <span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median")
      Df F value Pr(&gt;F)
group  3  0.0195 0.9962
      30               </code></pre>
</div>
</div>
<p>P-value &gt; 0.05: <span class="math inline">\(H_0\)</span> was not rejected.</p>
</section>
<section id="levene-mean-test" class="level4">
<h4 class="anchored" data-anchor-id="levene-mean-test">Levene-mean test</h4>
<p><span class="math inline">\(H_0\)</span>: no difference in variances of species diversity between zinc-level groups <span class="math inline">\(H_1\)</span>: different variances of species diversity between zinc-level groups</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(DIVERSTY <span class="sc">~</span> ZINC, <span class="at">data =</span> df, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value Pr(&gt;F)
group  3  0.0867 0.9668
      30               </code></pre>
</div>
</div>
<p>P-value &gt; 0.05: <span class="math inline">\(H_0\)</span> was not rejected.</p>
<p>Additionally, Levene’s test produced no evidence that the <span class="math inline">\(H_0\)</span> of no differences in variances of species diversity between the zinc-level groups should be rejected (Levene-mean: <span class="math inline">\(F_{3,30} = 0.087, P = 0.967\)</span>; Levene-median: <span class="math inline">\(F_{3,30} = 0.020, P = 0.996\)</span>)</p>
</section>
<section id="tukeys-pairwise-comparison" class="level4">
<h4 class="anchored" data-anchor-id="tukeys-pairwise-comparison">Tukey’s pairwise comparison</h4>
<p>Tukey’s pairwise comparison of group means: mean differences with Tukey adjusted P-values for each pairwise comparison in brackets.<br>
</p>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Background</th>
<th>Low</th>
<th>Medium</th>
<th>High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Background</td>
<td>0.000 (1.000)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Low</td>
<td>0.235 (0.746)</td>
<td>0.000 (1.000)</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Medium</td>
<td>0.080 (0.985)</td>
<td>0.315 (0.515)</td>
<td>0.000 (1.000)</td>
<td></td>
</tr>
<tr class="even">
<td>High</td>
<td>0.520 (0.122)</td>
<td>0.755 (0.012)</td>
<td>0.440 (0.209)</td>
<td>0.000 (1.000)</td>
</tr>
</tbody>
</table>
<p><strong>Let’s check in R!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to use the second model with the function aov()</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model2, <span class="at">conf.level=</span>.<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = DIVERSTY ~ ZINC, data = df)

$ZINC
                 diff        lwr        upr     p adj
HIGH-BACK -0.51972222 -1.1355064 0.09606192 0.1218677
LOW-BACK   0.23500000 -0.3986367 0.86863665 0.7457444
MED-BACK  -0.07972222 -0.6955064 0.53606192 0.9847376
LOW-HIGH   0.75472222  0.1389381 1.37050636 0.0116543
MED-HIGH   0.44000000 -0.1573984 1.03739837 0.2095597
MED-LOW   -0.31472222 -0.9305064 0.30106192 0.5153456</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(model2, <span class="at">conf.level=</span>.<span class="dv">95</span>), <span class="at">las =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="oneway_anova_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The only <span class="math inline">\(H_0\)</span> to be rejected is that of no difference in diatom diversity between sites with <strong>low zinc</strong> and sites with <strong>high zinc</strong>. We could also analyze these data with more robust methods, especially if we were concerned about underlying non-normality or outliers.</p>
</section>
<section id="kruskal-wallis-rank-sum-test-non-parametric" class="level4">
<h4 class="anchored" data-anchor-id="kruskal-wallis-rank-sum-test-non-parametric">Kruskal-Wallis rank sum test (non-parametric)</h4>
<p>To test the <span class="math inline">\(H_0\)</span> that there is no difference in the location of the distributions of diatom diversity between zinc levels, irrespective of the shape of these distributions, we would use the Kruskal–Wallis <strong>non-parametric</strong> test based on ranks sums.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(DIVERSTY <span class="sc">~</span> ZINC, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  DIVERSTY by ZINC
Kruskal-Wallis chi-squared = 8.7367, df = 3, p-value = 0.033</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the rank sum</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(df<span class="sc">$</span>DIVERSTY)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(rank <span class="sc">~</span> ZINC, <span class="at">data =</span> df, sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ZINC  rank
1 BACK 160.0
2 HIGH  85.5
3  LOW 183.0
4  MED 166.5</code></pre>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th>Zinc level</th>
<th>Rank sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Background</td>
<td>160.0</td>
</tr>
<tr class="even">
<td>Low</td>
<td>183.0</td>
</tr>
<tr class="odd">
<td>Medium</td>
<td>166.5</td>
</tr>
<tr class="even">
<td>High</td>
<td>85.5</td>
</tr>
</tbody>
</table>
<p>The Kruskal–Wallis H-statistic equals 8.737. The probability of getting this value of one more extreme when the <span class="math inline">\(H_0\)</span> is true (testing with a chi-square distribution with 3 df ) is 0.033, so we would reject the <span class="math inline">\(H_0\)</span>.</p>
</section>
<section id="pairwise-wilcoxon-rank-sum-tests" class="level4">
<h4 class="anchored" data-anchor-id="pairwise-wilcoxon-rank-sum-tests">Pairwise Wilcoxon Rank Sum Tests</h4>
<p>From the output of the Kruskal-Wallis test, we know that there is a significant difference between groups, but we don’t know which pairs of groups are different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(df<span class="sc">$</span>DIVERSTY, df<span class="sc">$</span>ZINC, <span class="at">p.adjust.method =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum exact test 

data:  df$DIVERSTY and df$ZINC 

     BACK   HIGH   LOW   
HIGH 0.0274 -      -     
LOW  0.6454 0.0093 -     
MED  0.8884 0.0625 0.3356

P value adjustment method: none </code></pre>
</div>
</div>
<p>Groups with p-value &lt; 0.05 are significantly different.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>