<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Simple Linear Regression (5.1, 5.2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.31/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./simple_linear_regression.html">Simple Linear Regression</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./UQAC_Couleur.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation &amp; Simple Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./non-parametric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other types of correlation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_linear_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mutiple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./oneway_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">One-way ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova_repeated_measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA with Repeated Measures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (fixed effects)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two_way_anova_fixed_random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (fixed and random effects)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-way-anova-random-block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-way ANOVA (random block)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-first-look-at-the-data" id="toc-a-first-look-at-the-data" class="nav-link active" data-scroll-target="#a-first-look-at-the-data">A first look at the data</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear regression</a></li>
  <li><a href="#main-info-about-the-model" id="toc-main-info-about-the-model" class="nav-link" data-scroll-target="#main-info-about-the-model">Main info about the model</a></li>
  <li><a href="#plot-of-the-regression-model" id="toc-plot-of-the-regression-model" class="nav-link" data-scroll-target="#plot-of-the-regression-model">Plot of the regression model</a></li>
  <li><a href="#residuals-vs.-fitted-data-non-transformed-data" id="toc-residuals-vs.-fitted-data-non-transformed-data" class="nav-link" data-scroll-target="#residuals-vs.-fitted-data-non-transformed-data">Residuals vs.&nbsp;fitted data (non transformed data)</a></li>
  <li><a href="#when-to-apply-the-log-transformation" id="toc-when-to-apply-the-log-transformation" class="nav-link" data-scroll-target="#when-to-apply-the-log-transformation">When to apply the log transformation:</a></li>
  <li><a href="#model-with-the-transformed-data" id="toc-model-with-the-transformed-data" class="nav-link" data-scroll-target="#model-with-the-transformed-data">Model with the transformed data</a></li>
  <li><a href="#main-info-about-the-new-model" id="toc-main-info-about-the-new-model" class="nav-link" data-scroll-target="#main-info-about-the-new-model">Main info about the new model</a></li>
  <li><a href="#plot-of-the-regression-line" id="toc-plot-of-the-regression-line" class="nav-link" data-scroll-target="#plot-of-the-regression-line">Plot of the regression line</a></li>
  <li><a href="#residuals-vs.-fitted-data-transformed-data" id="toc-residuals-vs.-fitted-data-transformed-data" class="nav-link" data-scroll-target="#residuals-vs.-fitted-data-transformed-data">Residuals vs.&nbsp;fitted data (transformed data)</a></li>
  <li><a href="#comparing-the-regression-lines" id="toc-comparing-the-regression-lines" class="nav-link" data-scroll-target="#comparing-the-regression-lines">Comparing the regression lines</a></li>
  <li><a href="#comparing-the-residuals" id="toc-comparing-the-residuals" class="nav-link" data-scroll-target="#comparing-the-residuals">Comparing the residuals</a></li>
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance">Cook’s Distance</a></li>
  <li><a href="#creating-a-new-column-based-on-a-unity-transformation" id="toc-creating-a-new-column-based-on-a-unity-transformation" class="nav-link" data-scroll-target="#creating-a-new-column-based-on-a-unity-transformation">Creating a new column based on a unity transformation</a></li>
  <li><a href="#new-regression-with-transformed-unit-of-area" id="toc-new-regression-with-transformed-unit-of-area" class="nav-link" data-scroll-target="#new-regression-with-transformed-unit-of-area">New regression with transformed unit of area</a></li>
  <li><a href="#analysis-of-variance-of-the-model" id="toc-analysis-of-variance-of-the-model" class="nav-link" data-scroll-target="#analysis-of-variance-of-the-model">Analysis of variance of the model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simple Linear Regression (5.1, 5.2)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Example from the book <em>Experimental Design and Data Analysis for Biologists</em> by Gerry P. Quinn and Michael J. Keough</p>
<p>Page 81, Chapter 5 - Correlation and regression.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Box 5.4 - Worked example of linear regression analysis: species richness of macroinvertebrates in mussel clumps.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Peake &amp; Quinn (1993) investigated the relationship between the number of species of macroinvertebrates, and the total abundance of macroinvertebrates, and area of clumps of mussels on a rocky shore in southern Australia. The variables of interest are clump area (dm<span class="math inline">\(^2\)</span>), number of species, and number of individuals.</p>
<section id="number-of-species-against-clump-area" class="level5">
<h5 class="anchored" data-anchor-id="number-of-species-against-clump-area">Number of species against clump area</h5>
<p>A scatterplot of number of species against clump area, and the plot of residuals against predicted number of species from a linear regression analysis,both suggested a nonlinear relationship (Figure 5.17(a,b)). Although only clump area was positively skewed, Peake &amp; Quinn (1993) transformed both variables because of the nature of the species–area relationships for other seasons in their study plus the convention in species–area studies to transform both variables. The scatterplot of log number of species against log clump area (Figure 5.18) linearized the relationship effectively except for one of the small clumps. The residual plot also showed no evidence of nonlinearity but that same clump had a larger residual and was relatively influential (Cook’s D<span class="math inline">\(_i\)</span> = 1.02). Reexamination of the raw data did not indicate any problems with this observation and omitting it did not alter the conclusions from the analysis (<span class="math inline">\(\beta_1\)</span> changed from 0.386 to 0.339, r<span class="math inline">\(^2\)</span> from 0.819 to 0.850, all tests still P &lt; 0.001) so it was not excluded from the analysis. In fact, just transforming clump area produced the best linearizing of the relationship with no unusually large residuals or Cook’s D<span class="math inline">\(_i\)</span> statistics but, for the reasons outlined above, both variables were transformed. The results of the OLS fit of a linear regression model to log number of species and log clump area were as follows.</p>
<p>The results of the OLS fit of a linear regression model to log number of species and log clump area were as follows.</p>
<p>The <span class="math inline">\(t\)</span> test and the ANOVA <span class="math inline">\(F\)</span> test cause us to reject the <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_1\)</span> equals zero. We would also reject the <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_0\)</span> equals zero, indicating that the relationship between species number and clump area must be nonlinear for small clump sizes since the model must theoretically go through the origin. The <span class="math inline">\(r^2\)</span> value (0.819) indicates that we can explain about 82% of the total variation in log number of species by the linear regression with log clump area.</p>
</section>
<section id="number-of-individuals-against-clump-area" class="level5">
<h5 class="anchored" data-anchor-id="number-of-individuals-against-clump-area">Number of individuals against clump area</h5>
<p>A scatterplot of number of individuals against clump area, with a Loess smoother fitted, suggested an approximately linear relationship (Figure 5.19(a)). The plot of residuals against predicted number of individuals from a linear regression model fitted to number of individuals against clump area (Figure 5.19(b)) showed a clear pattern of increasing spread of residuals against increasing predicted number of individuals (or, equivalently, clump area); the pattern in the residuals was wedge-shaped. The boxplots in Figure 5.19(a) indicated that both variables were positively skewed so we transformed both variables to logs to correct for variance heterogeneity. The scatterplot of log number of individuals against log clump area (Figure 5.20(a)) showed an apparent reasonable fit of a linear regression model, with symmetrical boxplots for both variables. The residual plot showed a more even spread of residuals with little wedge-shaped pattern (Figure 5.20(b)). The results of the OLS fit of a linear regression model to log number of individuals and log clump area were as follows.</p>
<p>The <span class="math inline">\(t\)</span> test and the ANOVA <span class="math inline">\(F\)</span> test cause us to reject the <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_1\)</span> equals zero. We would also reject the <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_0\)</span> equals zero, although this test is of little biological interest. The <span class="math inline">\(r^2\)</span> value (0.859) indicates that we can explain about 86% of the total variation in log number of individuals by the linear regression with log clump area.</p>
</section>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get thedata</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/peake.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-28d39b983e4310255296" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-28d39b983e4310255296">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],[516,469.06,462.25,938.6,1357.15,1773.66,1686.01,1786.29,3090.07,3980.12,4424.84,4451.68,4982.89,4450.86,5490.74,7476.21,7138.82,9149.940000000001,10133.07,9287.690000000001,13729.13,20300.77,24712.72,27144.03,26117.81],[3,7,6,8,10,9,10,11,16,9,13,14,12,14,20,22,15,20,22,21,15,24,25,25,24],[18,60,57,100,48,118,148,214,225,283,380,278,338,274,569,509,682,600,978,363,1402,675,1159,1062,632],[2.71264970162721,2.67122839922309,2.66487691983121,2.97248054987648,3.13262785102901,3.24887037182281,3.22686014616769,3.25195196696895,3.48996831769972,3.59989616618228,3.64589757144664,3.64852393840548,3.69748129999058,3.6484439339402,3.73963087928783,3.87368149181866,3.85362643168653,3.96141824622444,4.00574104280032,3.96790771130242,4.13764301734087,4.30751251083977,4.39292054855787,4.43367432662628,4.4169367581777],[0.477121254719662,0.845098040014257,0.778151250383644,0.903089986991944,1,0.954242509439325,1,1.04139268515823,1.20411998265592,0.954242509439325,1.11394335230684,1.14612803567824,1.07918124604762,1.14612803567824,1.30102999566398,1.34242268082221,1.17609125905568,1.30102999566398,1.34242268082221,1.32221929473392,1.17609125905568,1.38021124171161,1.39794000867204,1.39794000867204,1.38021124171161],[1.25527250510331,1.77815125038364,1.75587485567249,2,1.68124123737559,2.07188200730613,2.17026171539496,2.33041377334919,2.35218251811136,2.45178643552429,2.57978359661681,2.44404479591808,2.52891670027765,2.43775056282039,2.75511226639507,2.70671778233676,2.83378437465648,2.77815125038364,2.9903388547876,2.55990662503611,3.14674801363064,2.82930377283103,3.0640834359636,3.02612451674545,2.80071707828239],[-7.19636309692717,-3.16541577209953,-4.16092597060665,-2.47498132172811,-0.750929400266767,-2.02553251624368,-0.96774527676473,-0.0338594168097814,4.10656446125227,-3.48024138584684,0.226556775692499,1.20886128787031,-1.14136300743615,1.2094019100765,6.52381383718013,7.21480265214573,0.437242318178841,4.11132020681661,5.46314714636097,5.02050226913007,-3.90771857412576,0.759629578191114,-1.149148644503,-2.75210007881627,-3.07551798072061],[10.1963630969272,10.1654157720995,10.1609259706066,10.4749813217281,10.7509294002668,11.0255325162437,10.9677452767647,11.0338594168098,11.8934355387477,12.4802413858468,12.7734432243075,12.7911387121297,13.1413630074362,12.7905980899235,13.4761861628199,14.7851973478543,14.5627576818212,15.8886797931834,16.536852853639,15.9794977308699,18.9077185741258,23.2403704218089,26.149148644503,27.7521000788163,27.0755179807206],[-0.296087244808144,0.0878712131815452,0.0233750288887437,0.0296303767604241,0.0647504024558824,-0.0258571969317423,0.0283925476612499,0.0601040001180737,0.130996922724628,-0.161294255338415,-0.0193422363798284,0.0118291100205639,-0.0740070066822645,0.0118599783203042,0.131579077555003,0.12125071847511,-0.0373428150959924,0.0460063673658053,0.0702978899170299,0.0646918217755596,-0.146925562340882,-0.008346701967727551,-0.0235711070496347,-0.039295227354285,-0.0505661012710073],[0.773208499527806,0.757226826832712,0.7547762214949,0.87345961023152,0.935249597544118,0.980099706371067,0.97160745233875,0.981288685040156,1.07312305993129,1.11553676477774,1.13328558868667,1.13429892565768,1.15318825272988,1.13426805735794,1.16945091810898,1.2211719623471,1.21343407415167,1.25502362829817,1.27212479090518,1.25752747295836,1.32301682139656,1.38855794367934,1.42151111572167,1.43723523602633,1.43077734298262],[-166.608317944447,-122.918638415907,-125.673501696918,-99.8204732226972,-166.886842346482,-111.879778444315,-78.72467808904101,-16.3344152667573,-52.2660380984584,-26.3047953284785,54.686805013823,-48.2793432295945,-7.40108720820126,-52.249826032888,205.318048953514,73.8479165817503,258.992803163219,104.599358479844,447.210039457823,-137.359170601034,741.764173130554,-221.792400728318,103.392482187263,-81.12636601331,-474.185954300944],[184.608317944447,182.918638415907,182.673501696918,199.820473222697,214.886842346482,229.879778444315,226.724678089041,230.334415266757,277.266038098458,309.304795328478,325.313194986177,326.279343229594,345.401087208201,326.249826032888,363.681951046486,435.15208341825,423.007196836781,495.400641520156,530.789960542177,500.359170601034,660.235826869446,896.7924007283179,1055.60751781274,1143.12636601331,1106.18595430094],[-0.433547384240728,0.123914654355805,0.106941209142913,0.09424327100928299,-0.358224978475774,-0.0646369074972044,0.0521194822893722,0.191321986554025,0.0143671568842807,0.0221905940361121,0.111780462289473,-0.0261511332665351,0.0178455040826952,-0.0323785693846811,0.208849727113667,0.0485342897463699,0.192345165484719,0.0467149691044026,0.221896777321106,-0.176947812149172,0.268178914323638,-0.191092023807467,-0.0276208673738979,-0.0996057533985053,-0.311038734143898],[1.68881988934404,1.65423659602784,1.64893364652958,1.90575672899072,2.03946621585136,2.13651891480333,2.11814223310559,2.13909178679517,2.33781536122708,2.42959584148818,2.46800313432734,2.47019592918462,2.51107119619495,2.47012913220507,2.5462625392814,2.65818349259039,2.64143920917176,2.73143628127924,2.76844207746649,2.73685443718528,2.878569099307,3.0203957966385,3.0917043033375,3.12573027014396,3.11175581242629]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>AREA<\/th>\n      <th>SPECIES<\/th>\n      <th>INDIV<\/th>\n      <th>LAREA<\/th>\n      <th>LSPECIES<\/th>\n      <th>LINDIV<\/th>\n      <th>RESID1<\/th>\n      <th>PREDICT1<\/th>\n      <th>RESID2<\/th>\n      <th>PREDICT2<\/th>\n      <th>RESID3<\/th>\n      <th>PREDICT3<\/th>\n      <th>RESID4<\/th>\n      <th>PREDICT4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"AREA","targets":1},{"name":"SPECIES","targets":2},{"name":"INDIV","targets":3},{"name":"LAREA","targets":4},{"name":"LSPECIES","targets":5},{"name":"LINDIV","targets":6},{"name":"RESID1","targets":7},{"name":"PREDICT1","targets":8},{"name":"RESID2","targets":9},{"name":"PREDICT2","targets":10},{"name":"RESID3","targets":11},{"name":"PREDICT3","targets":12},{"name":"RESID4","targets":13},{"name":"PREDICT4","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="a-first-look-at-the-data" class="level4">
<h4 class="anchored" data-anchor-id="a-first-look-at-the-data">A first look at the data</h4>
<p>We want to adjust the number of species (Y) based on its area (X).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> AREA, <span class="at">y =</span> SPECIES)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression">Linear regression</h4>
<p>We use the function <code>lm()</code> to adjust the linear regression model. We use the following formula: <code>Y ~ X.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(SPECIES <span class="sc">~</span> AREA, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="main-info-about-the-model" class="level4">
<h4 class="anchored" data-anchor-id="main-info-about-the-model">Main info about the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SPECIES ~ AREA, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1964 -2.7521 -0.7509  1.2094  7.2148 

Coefficients:
              Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept) 9.85616668 1.04396038   9.441 0.00000000224 ***
AREA        0.00065930 0.00009283   7.102 0.00000031024 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.759 on 23 degrees of freedom
Multiple R-squared:  0.6868,    Adjusted R-squared:  0.6732 
F-statistic: 50.44 on 1 and 23 DF,  p-value: 0.0000003102</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
We obtained:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Estimate</strong>: The estimated coefficients for each predictor, including the intercept. These show how much the dependent variable changes for a one-unit change in the predictor.</p></li>
<li><p><strong>Std. Error</strong>: The standard error of the estimated coefficients, indicating the variability in the coefficient estimates.</p></li>
<li><p><strong>t-value</strong>: The t-statistic for testing whether the coefficient is significantly different from zero. It is calculated as the Estimate divided by the Std. Error.</p></li>
<li><p><strong>Pr(&gt;|t|)</strong>: The p-value corresponding to the t-statistic, which indicates whether the predictor is statistically significant. A small p-value (e.g., &lt; 0.05) suggests the predictor significantly contributes to the model.</p></li>
</ul>
</div>
</div>
</section>
<section id="plot-of-the-regression-model" class="level4">
<h4 class="anchored" data-anchor-id="plot-of-the-regression-model">Plot of the regression model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> AREA, <span class="at">y =</span> SPECIES)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                        <span class="co"># Scatter plot</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="residuals-vs.-fitted-data-non-transformed-data" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs.-fitted-data-non-transformed-data">Residuals vs.&nbsp;fitted data (non transformed data)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There shouldn’t be a large variation of the residuals. We will change the scale of the data. Let’s take a look at the data distributions first using histograms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of area</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>AREA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of area</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>AREA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  462.2  1773.7  4451.7  7802.0  9287.7 27144.0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of species</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>SPECIES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of species</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>SPECIES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      3      10      14      15      21      25 </code></pre>
</div>
</div>
</section>
<section id="when-to-apply-the-log-transformation" class="level4">
<h4 class="anchored" data-anchor-id="when-to-apply-the-log-transformation">When to apply the log transformation:</h4>
<ul>
<li><p>When your residuals show non-constant variance (heteroscedasticity) or skewness.</p></li>
<li><p>When the relationship between variables seems non-linear but multiplicative.</p></li>
<li><p>When your variables contain large ranges of values or outliers that affect the model.</p></li>
</ul>
<p>We could have transformed the data into <span class="math inline">\(log_{10}\)</span> using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log10</span>(df<span class="sc">$</span>AREA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.712650 2.671228 2.664877 2.972481 3.132628 3.248870 3.226860 3.251952
 [9] 3.489968 3.599896 3.645898 3.648524 3.697481 3.648444 3.739631 3.873681
[17] 3.853626 3.961418 4.005741 3.967908 4.137643 4.307513 4.392921 4.433674
[25] 4.416937</code></pre>
</div>
</div>
<p>We already the have the transformed data (<span class="math inline">\(log_{10}\)</span>) ready on the variable <code>LAREA</code> and <code>LESPECIES</code>.</p>
</section>
<section id="model-with-the-transformed-data" class="level4">
<h4 class="anchored" data-anchor-id="model-with-the-transformed-data">Model with the transformed data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_transformed <span class="ot">&lt;-</span> <span class="fu">lm</span>(LSPECIES <span class="sc">~</span> LAREA, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="main-info-about-the-new-model" class="level4">
<h4 class="anchored" data-anchor-id="main-info-about-the-new-model">Main info about the new model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LSPECIES ~ LAREA, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29609 -0.03734  0.01186  0.06469  0.13158 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept) -0.27342    0.13846  -1.975         0.0604 .  
LAREA        0.38583    0.03777  10.215 0.000000000511 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.09921 on 23 degrees of freedom
Multiple R-squared:  0.8194,    Adjusted R-squared:  0.8115 
F-statistic: 104.4 on 1 and 23 DF,  p-value: 0.0000000005107</code></pre>
</div>
</div>
</section>
<section id="plot-of-the-regression-line" class="level4">
<h4 class="anchored" data-anchor-id="plot-of-the-regression-line">Plot of the regression line</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> LAREA, <span class="at">y =</span> LSPECIES)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                        <span class="co"># Scatter plot</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>)  </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="residuals-vs.-fitted-data-transformed-data" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs.-fitted-data-transformed-data">Residuals vs.&nbsp;fitted data (transformed data)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_transformed, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparing-the-regression-lines" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-regression-lines">Comparing the regression lines</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparing-the-residuals" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-residuals">Comparing the residuals</h4>
<p>Let’s check the difference in the residuals with non transformed and transformed data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals versus fitted of non transformed data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals versus fitted of transformed data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_transformed, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cooks-distance" class="level4">
<h4 class="anchored" data-anchor-id="cooks-distance">Cook’s Distance</h4>
<p>We will analyse now another measure called Cook’s Distance. It is used to help identify influential data points that have a significant impact on the fitted model. It combines information on both leverage (how far the independent variable is from the mean) and residuals (how far the predicted value is from the actual value).</p>
<p>What Cook’s Distance represents:</p>
<ul>
<li><p><strong>Influence</strong>: It shows how much the estimated regression coefficients (the slope and intercept) would change if a particular data point were removed from the analysis.</p></li>
<li><p>A large Cook’s Distance indicates that a point is influential, meaning it has a considerable impact on the regression model, and removing it could lead to a significantly different model.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>A general rule of thumb is that points with a <strong>Cook’s Distance greater than 1</strong> may be considered influential.</p></li>
<li><p>However, this threshold can vary depending on the dataset and the number of observations. For smaller datasets, a lower threshold might be more appropriate.</p></li>
</ul>
</div>
</div>
<p>We can get the values using the following function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the values and add in the dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cook <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see the first 5 variables and the cook’s distance values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-9531e8297ab8b7dadd60" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9531e8297ab8b7dadd60">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],[516,469.06,462.25,938.6,1357.15,1773.66,1686.01,1786.29,3090.07,3980.12,4424.84,4451.68,4982.89,4450.86,5490.74,7476.21,7138.82,9149.940000000001,10133.07,9287.690000000001,13729.13,20300.77,24712.72,27144.03,26117.81],[3,7,6,8,10,9,10,11,16,9,13,14,12,14,20,22,15,20,22,21,15,24,25,25,24],[18,60,57,100,48,118,148,214,225,283,380,278,338,274,569,509,682,600,978,363,1402,675,1159,1062,632],[2.71264970162721,2.67122839922309,2.66487691983121,2.97248054987648,3.13262785102901,3.24887037182281,3.22686014616769,3.25195196696895,3.48996831769972,3.59989616618228,3.64589757144664,3.64852393840548,3.69748129999058,3.6484439339402,3.73963087928783,3.87368149181866,3.85362643168653,3.96141824622444,4.00574104280032,3.96790771130242,4.13764301734087,4.30751251083977,4.39292054855787,4.43367432662628,4.4169367581777],[0.477121254719662,0.845098040014257,0.778151250383644,0.903089986991944,1,0.954242509439325,1,1.04139268515823,1.20411998265592,0.954242509439325,1.11394335230684,1.14612803567824,1.07918124604762,1.14612803567824,1.30102999566398,1.34242268082221,1.17609125905568,1.30102999566398,1.34242268082221,1.32221929473392,1.17609125905568,1.38021124171161,1.39794000867204,1.39794000867204,1.38021124171161],[1.022785351769609,0.09898957466468226,0.007106909193142721,0.005662224179060262,0.01883898494790876,0.002343148222201684,0.002956444634620654,0.01258104401920914,0.04068779305897509,0.05754320522523387,0.0008259529606492479,0.0003090416645774876,0.01230523812335672,0.0003106526973932115,0.04004579023959595,0.04023081446314308,0.00369809325539315,0.006771188532191131,0.01726307309726399,0.01355765000908013,0.1000737141667639,0.0004743851878178376,0.00459817608110849,0.01402497169108942,0.02235398555775208]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>AREA<\/th>\n      <th>SPECIES<\/th>\n      <th>INDIV<\/th>\n      <th>LAREA<\/th>\n      <th>LSPECIES<\/th>\n      <th>cook<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"AREA","targets":1},{"name":"SPECIES","targets":2},{"name":"INDIV","targets":3},{"name":"LAREA","targets":4},{"name":"LSPECIES","targets":5},{"name":"cook","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What we observed
</div>
</div>
<div class="callout-body-container callout-body">
<p>The first value <code>LAREA</code> = 2.71 and <code>LSPECIES</code> = 0.47 has a Cook’s Distance of 1.022, which is higher than 1, considered influential.</p>
<p>However, deciding whether to delete a point based solely on Cook’s Distance requires careful consideration of the context and the nature of the data. Here’s when and how to evaluate whether to delete a point with a high Cook’s Distance value:</p>
<ul>
<li><p><strong>Check for Data Entry Errors</strong>: If the data point with high Cook’s Distance is a result of an entry mistake (e.g., a typo or incorrect measurement), you can justify removing or correcting it.</p></li>
<li><p><strong>Check for Validity</strong>: Ensure the data point is valid and not an outlier due to faulty data collection or recording. If it’s valid, you might consider keeping it, but see if it warrants a different treatment (such as robust regression).</p></li>
</ul>
<p>Based on these considerations, we decided not to delete this point.</p>
</div>
</div>
<p>We can also plot these values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_transformed, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="creating-a-new-column-based-on-a-unity-transformation" class="level4">
<h4 class="anchored" data-anchor-id="creating-a-new-column-based-on-a-unity-transformation">Creating a new column based on a unity transformation</h4>
<p>Now, we will change the air unit from <span class="math inline">\(cm^2\)</span> to <span class="math inline">\(dm^2\)</span> and insert in a new column called <code>LDMAREA</code>.</p>
<p>We will apply the following formula:</p>
<p><span class="math inline">\(log_{10}\)</span> of (area / 10000)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>LDMAREA <span class="ot">&lt;-</span> <span class="fu">log10</span>(df<span class="sc">$</span>AREA<span class="sc">/</span><span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="new-regression-with-transformed-unit-of-area" class="level4">
<h4 class="anchored" data-anchor-id="new-regression-with-transformed-unit-of-area">New regression with transformed unit of area</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model_new_unit <span class="ot">&lt;-</span> <span class="fu">lm</span>(LSPECIES <span class="sc">~</span> LDMAREA, <span class="at">data =</span> df)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_new_unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LSPECIES ~ LDMAREA, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29609 -0.03734  0.01186  0.06469  0.13158 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  1.26991    0.02431   52.24 &lt; 0.0000000000000002 ***
LDMAREA      0.38583    0.03777   10.21       0.000000000511 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.09921 on 23 degrees of freedom
Multiple R-squared:  0.8194,    Adjusted R-squared:  0.8115 
F-statistic: 104.4 on 1 and 23 DF,  p-value: 0.0000000005107</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Checking the estimated coefficients, the new regression line can be expressed by</p>
<p>LSPECIES = 1.26 + 0.38*LMDAREA</p>
</div>
</div>
</section>
<section id="analysis-of-variance-of-the-model" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-variance-of-the-model">Analysis of variance of the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_new_unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: LSPECIES
          Df  Sum Sq Mean Sq F value          Pr(&gt;F)    
LDMAREA    1 1.02705 1.02705  104.35 0.0000000005107 ***
Residuals 23 0.22637 0.00984                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The variable <code>LDMAREA</code> has 1 degree of freedom <code>(df)</code> and the residuals/errors have 23 degrees of freedom.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>